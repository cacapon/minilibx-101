# 101-03 入力を受け付けよう 

02のレッスンまで進めることで画像を表示することができました。

しかし、今の段階では表示するだけでこちらからのアクションを何も受け付けません。

入力で画面を操作できるようにしてみましょう。

まずは、キー入力で画面を閉じるように…ESC押したら消せるようにしましょうか。

それもできたら十字キー（もしくはWASDキー）で押されたらキー表示されるようにしてみましょう。

## コードの解説

mlx_hookを使ってkeyを押したときと離したときを判定できるようにします。

これを実現しているのがmlx_hook関数です。

mlx_hookイベントはx_eventとx_maskというX11関連のイベントをコントロールでき、

x_event=2, x_mask=1L<<0でキーの押下

x_event=3, x_mask=1L<<1でキーを離したときにイベント発行してユーザ関数を実行します

今回の例ではsysにkey_flgという構造体を用意し、フラグ監視したいキーをバイナリ値で保存しています。

また、入力と描画を分離したかったので　描画は_drawという関数にまとめました。

drawはMAPを描画後キーフラグに基づいて表示する内容を決定します。

## 使用した関数について

### int mlx_string_put(void \*mlx_ptr, void \*win_ptr, int x, int y, int color, char \*string)

ウィンドウに文字を描画する関数

x,yの位置にcolorの色でstringを表示します。

日本語は未対応の模様

### int mlx_hook(void \*win_ptr, int x_event, int x_mask, int (\*funct)(), void \*param)

functをx_event,x_mask時に発行するように登録します。

例えば、キーを押したときにキャラを動かすなどを設定できます。

### int mlx_loop_hook(void \*mlx_ptr, int (\*funct_ptr)(), void \*param)

こちらもイベントに関数を登録する関数ですが、ここに登録すると毎ループ実行されます。

更新処理や描画処理などを登録するのが良いでしょう。
